<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SynapticFlow</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header class="header">
            <h1><img src="assets/logo.png" alt="Voice Assistant" class="header-logo"> SynapticFlow</h1>
            <div class="recording-indicator" id="recordingIndicator" style="display: none;">
                <div class="mic-animation"><img src="assets/logo.png" alt="Recording" class="recording-logo"></div>
                <span>RECORDING - Speak Now!</span>
                <!-- Enhanced: Recording progress bar -->
                <div class="recording-progress-container" id="recordingProgressContainer" style="display: none;">
                    <div class="recording-progress-bar">
                        <div class="recording-progress-fill" id="recordingProgressFill" style="width: 0%"></div>
                    </div>
                    <div class="recording-time-info">
                        <span id="recordingElapsed">0s</span> / <span id="recordingRemaining">5m</span>
                    </div>
                </div>
            </div>
            <div class="status-indicator" id="statusIndicator">
                <span class="status-text" id="statusText">Ready</span>
            </div>
        </header>

        <main class="main-content">
            <section class="instruction-section">
                <h2>üìù Instruction Template</h2>
                <div class="template-selector">
                    <select id="templateSelect" class="template-select">
                        <option value="" class="custom-instruction-option">üîß Custom instruction...</option>
                    </select>
                    <button id="addTemplateBtn" class="btn btn-small">Add</button>
                    <button id="editTemplateBtn" class="btn btn-small">Edit</button>
                    <button id="deleteTemplateBtn" class="btn btn-small">Delete</button>
                    <button id="exportTemplatesBtn" class="btn btn-small">Export</button>
                    <button id="importTemplatesBtn" class="btn btn-small">Import</button>
                </div>
                <textarea id="instructionInput" placeholder="Enter your markdown instruction here...&#10;&#10;Example:&#10;Please rewrite the following transcript in a professional tone:" class="instruction-textarea"></textarea>
                
                <!-- RAG Search Section -->
                <div class="rag-search-container">
                    <div class="rag-search-checkbox">
                        <input type="checkbox" id="ragSearchCheckbox" class="rag-search-checkbox-input">
                        <label for="ragSearchCheckbox" class="rag-search-label">üîç RAG Search</label>
                    </div>
                    
                    <!-- RAG Associations Section (hidden by default) -->
                    <div id="ragAssociationsSection" class="rag-associations-section" style="display: none;">
                        <h4>RAG Associations (Max 5)</h4>
                        <div id="ragAssociationsList" class="rag-associations-list">
                            <!-- Dynamic RAG associations will be added here -->
                        </div>
                        <button id="addRagAssociationBtn" class="btn btn-small">Add RAG Association</button>
                    </div>
                </div>
                
                <!-- NEW: Web Search Section -->
                <div class="web-search-container" style="display: none;">
                    <div class="web-search-checkbox">
                        <input type="checkbox" id="webSearchCheckbox" class="web-search-checkbox-input">
                        <label for="webSearchCheckbox" class="web-search-label">üåê Web Search</label>
                    </div>
                    
                    <!-- Web Search Options Section (hidden by default) -->
                    <div id="webSearchOptionsSection" class="web-search-options-section" style="display: none;">
                        <div class="web-search-option">
                            <label>Maximum results: <span id="webSearchResultsValue">5</span></label>
                            <input type="range" id="webSearchResultsSlider" min="1" max="10" value="5" class="setting-slider">
                        </div>
                    </div>
                </div>
            </section>

            <section class="llm-clipboard-section">
                <h2>üìã LLM Clipboard</h2>
                <div class="llm-clipboard-status">
                    <div class="status-indicator" id="llmClipboardStatus">
                        <span class="status-text" id="llmClipboardText">No content in LLM clipboard</span>
                    </div>
                    <div class="llm-clipboard-actions">
                        <button id="clearLlmClipboard" class="btn btn-small">Clear</button>
                    </div>
                </div>
                <div class="llm-clipboard-preview" id="llmClipboardPreview">
                    <h4>LLM Clipboard Content:</h4>
                    <div id="llmClipboardContent" class="clipboard-content"></div>
                </div>
            </section>

            <section class="conversation-section">
                <h2>üí¨ Conversation</h2>
                <!-- Enhanced: Chunked transcription progress -->
                <div class="transcription-progress" id="transcriptionProgress" style="display: none;">
                    <div class="progress-header">
                        <h4>üîÑ Processing Long Audio</h4>
                        <span id="chunkProgressText">Analyzing file...</span>
                    </div>
                    <div class="chunk-progress-bar">
                        <div class="chunk-progress-fill" id="chunkProgressFill" style="width: 0%"></div>
                    </div>
                    <div class="chunk-info">
                        <span id="chunkCurrent">0</span> of <span id="chunkTotal">0</span> chunks processed
                    </div>
                </div>
                <div class="conversation-container">
                    <div class="transcript-container">
                        <h3>üìù Your Speech (Transcript)</h3>
                <div id="transcriptDisplay" class="transcript-display">
                    <p class="no-transcript">No transcript yet. Use the hotkey to start recording.</p>
                        </div>
                    </div>
                    <div class="response-container">
                        <h3>ü§ñ AI Response</h3>
                        <div id="responseDisplay" class="response-display">
                            <p class="no-response">AI response will appear here after processing.</p>
                        </div>
                    </div>
                </div>
            </section>

            <section class="rag-store-section">
                <h2>üóÑÔ∏è RAG Store</h2>
                <div class="template-selector">
                    <select id="ragStoreSelect" class="template-select">
                        <option value="">Select RAG Store...</option>
                    </select>
                    <button id="addRagStoreBtn" class="btn btn-small">Add</button>
                    <button id="editRagStoreBtn" class="btn btn-small">Edit</button>
                    <button id="deleteRagStoreBtn" class="btn btn-small">Delete</button>
                    <button id="exportRagStoresBtn" class="btn btn-small">Export</button>
                    <button id="importRagStoresBtn" class="btn btn-small">Import</button>
                </div>
                
                <!-- RAG Testing Section -->
                <div class="rag-testing-section" style="margin-top: 15px; padding: 15px; background: #f8f9fa; border-radius: 5px;">
                    <h4>üß™ Test RAG Functionality</h4>
                    <div class="rag-test-input">
                        <input type="text" id="ragTestQuery" placeholder="Enter test query for RAG..." class="modal-input" style="margin-bottom: 10px;">
                        <div class="rag-test-controls" style="display: flex; align-items: center; gap: 10px; margin-bottom: 10px;">
                            <label for="maxResultsSelect" style="font-size: 0.9em; color: #666;">Max Results:</label>
                            <input type="number" id="maxResultsSelect" min="1" max="50" step="1" value="5" 
                                   style="padding: 5px; border: 1px solid #ddd; border-radius: 3px; font-size: 0.9em; width: 80px;" 
                                   title="Enter a value between 1 and 50"
                                   oninput="validateMaxResults(this)"
                                   onblur="correctMaxResults(this)">
                        </div>
                        <div class="rag-test-buttons">
                            <button id="testDirectSearchBtn" class="btn btn-small">Direct Search</button>
                            <button id="testRagQueryBtn" class="btn btn-small">RAG Query</button>
                        </div>
                    </div>
                    <div id="ragTestResults" class="rag-test-results" style="margin-top: 10px; display: none;">
                        <h5>Results:</h5>
                        <div id="ragTestContent" style="max-height: 300px; overflow-y: auto; background: white; padding: 10px; border-radius: 3px; border: 1px solid #ddd;"></div>
                    </div>
                </div>
            </section>

            <section class="settings-section">
                <h2>‚öôÔ∏è Settings</h2>
                <div class="settings-grid">
                    <div class="setting-item">
                        <label for="modelSelect">Model:</label>
                        <select id="modelSelect" class="setting-select">
                            <!-- OpenAI Models (Most ‚Üí Least Expensive) -->
                            <option value="gpt-4-preview">GPT-4.5 Preview (Premium/Research only - Best for complex reasoning)</option>
                            <option value="gpt-4o">GPT-4o (Best balance - Multimodal capabilities)</option>
                            <option value="gpt-4.1">GPT-4.1 (Coding specialist - Large context window)</option>
                            <option value="gpt-4.1-mini">GPT-4.1 Mini (Great middle option - Balanced performance)</option>
                            <option value="gpt-4o-mini" selected>GPT-4o Mini (Excellent value - Best for most tasks)</option>
                            <option value="gpt-3.5-turbo">GPT-3.5 Turbo (Budget option - Fast and reliable)</option>
                            <option value="gpt-4.1-nano">GPT-4.1 Nano (Cheapest OpenAI - Ultra budget)</option>
                            
                            <!-- Non-OpenAI Models -->
                            <option value="Claude-3.5-Sonnet">Claude-3.5-Sonnet</option>
                            <option value="DeepSeek-R1">DeepSeek-R1</option>
                            <option value="Meta-Llama-3.1-8B-Instruct">Meta-Llama-3.1-8B-Instruct</option>
                       </select>
                    </div>
                    <div class="setting-item">
                        <label for="useResponsesAPICheckbox">
                            üß™ Use Responses API (Beta):
                            <span class="setting-tooltip" title="Use OpenAI's newer Responses API for better RAG performance. Switch back to Chat Completions API if you encounter issues.">‚ÑπÔ∏è</span>
                        </label>
                        <div class="toggle-switch-container">
                            <input type="checkbox" id="useResponsesAPICheckbox" class="toggle-switch-input" title="Use OpenAI's newer Responses API for better RAG performance">
                            <label for="useResponsesAPICheckbox" class="toggle-switch-label">
                                <span class="toggle-switch-slider"></span>
                            </label>
                        </div>
                    </div>
                    <div class="setting-item">
                        <label for="temperatureSlider">Temperature:</label>
                        <input type="range" id="temperatureSlider" min="0" max="1" step="0.1" value="0.7" class="setting-slider">
                        <span id="temperatureValue" class="setting-value">0.7</span>
                    </div>
                    <div class="setting-item">
                        <label for="maxTokensInput">Max Tokens:</label>
                        <input type="number" id="maxTokensInput" min="100" max="4000" value="1000" class="setting-input">
                    </div>
                    <div class="setting-item">
                        <label for="autoPasteCheckbox">Auto-Paste:</label>
                        <div class="toggle-switch-container">
                            <input type="checkbox" id="autoPasteCheckbox" class="toggle-switch-input" checked>
                            <label for="autoPasteCheckbox" class="toggle-switch-label">
                                <span class="toggle-switch-slider"></span>
                            </label>
                        </div>
                    </div>
                    <div class="setting-item">
                        <label for="llmShortcutsEnabled">Enable Ctrl+C/V Shortcuts:</label>
                        <div class="toggle-switch-container">
                            <input type="checkbox" id="llmShortcutsEnabled" class="toggle-switch-input" checked title="Enable/disable Ctrl+C processing shortcut">
                            <label for="llmShortcutsEnabled" class="toggle-switch-label">
                                <span class="toggle-switch-slider"></span>
                            </label>
                        </div>
                    </div>
                    <div class="setting-item copy-send-container">
                        <label for="copySendCheckbox">
                            Copy Send:
                            <div id="copySendLoadingIndicator" class="copy-send-loading"></div>
                        </label>
                        <div class="toggle-switch-container">
                            <input type="checkbox" id="copySendCheckbox" class="toggle-switch-input" title="Enable/disable copy send functionality">
                            <label for="copySendCheckbox" class="toggle-switch-label">
                                <span class="toggle-switch-slider"></span>
                            </label>
                        </div>
                    </div>
                </div>
            </section>

            <section class="api-section">
                <h2>üîë API Configuration</h2>
                <div class="api-input-group">
                    <input type="password" id="apiKeyInput" placeholder="Enter your OpenAI API key" class="api-input">
                    <button id="saveApiKey" class="btn btn-primary">Save</button>
                    <button id="testApiKey" class="btn btn-secondary">Test</button>
                </div>
                <div id="apiStatus" class="api-status"></div>
            </section>
        </main>

        <!-- Template Modal -->
        <div id="templateModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="modalTitle">Add Template</h3>
                    <span class="modal-close" id="modalClose">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="templateNameInput">Template Name:</label>
                        <input type="text" id="templateNameInput" class="modal-input" placeholder="Enter template name">
                    </div>
                    <div class="form-group">
                        <label for="templateContentInput">Template Content:</label>
                        <textarea id="templateContentInput" class="modal-textarea" placeholder="Enter template content" rows="6"></textarea>
                    </div>
                    
                    <!-- NEW: Web Search Configuration Section -->
                    <div class="form-group">
                        <label>
                            <input type="checkbox" id="templateWebSearchCheckbox">
                            üåê Enable Web Search for this template
                        </label>
                    </div>

                    <div id="webSearchConfigSection" style="display: none; margin-left: 20px; padding: 15px; background: rgba(0,0,0,0.05); border-radius: 8px; border: 1px solid #dee2e6;">
                        <div class="form-group">
                            <label for="webSearchMaxResults">Maximum search results (1-10):</label>
                            <input type="number" id="webSearchMaxResults" min="1" max="10" value="5" class="modal-input">
                        </div>
                        
                        <div class="form-group">
                            <label>
                                <input type="checkbox" id="webSearchIncludeResults" checked>
                                Include search results in the AI response
                            </label>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="modalSave" class="btn btn-primary">Save</button>
                    <button id="modalCancel" class="btn btn-secondary">Cancel</button>
                </div>
            </div>
        </div>

        <!-- RAG Store Modal -->
        <div id="ragStoreModal" class="modal" style="display: none;">
            <div class="modal-content">
                <div class="modal-header">
                    <h3 id="ragModalTitle">Add RAG Store</h3>
                    <span class="modal-close" id="ragModalClose">&times;</span>
                </div>
                <div class="modal-body">
                    <div class="form-group">
                        <label for="ragStoreNameInput">RAG Store Name:</label>
                        <input type="text" id="ragStoreNameInput" class="modal-input" placeholder="Enter RAG store name (max 100 chars)" maxlength="100">
                    </div>
                    
                    <!-- Upload Mode Toggle -->
                    <div class="upload-mode-toggle">
                        <input type="checkbox" id="uploadModeCheckbox" class="setting-checkbox">
                        <label for="uploadModeCheckbox">Upload file to create new vector store</label>
                    </div>
                    
                    <!-- File Upload Section (hidden by default) -->
                    <div id="fileUploadSection" class="form-group" style="display: none;">
                        <label for="fileUploadInput">Upload File:</label>
                        <div class="file-upload-container" id="fileUploadContainer">
                            <input type="file" id="fileUploadInput" class="file-input" accept=".txt,.pdf,.doc,.docx,.md,.json,.csv">
                            <div class="file-upload-dropzone">
                                <div>üìÅ Click to browse or drag & drop your file here</div>
                                <div class="file-upload-info">
                                    <span id="selectedFileName">No file selected</span>
                                    <button type="button" id="browseFileBtn" class="btn btn-small">Browse</button>
                                </div>
                            </div>
                        </div>
                        <small class="file-help-text">Supported formats: TXT, PDF, DOC, DOCX, MD, JSON, CSV (Max 20MB)</small>
                        
                        <!-- Upload Progress -->
                        <div id="uploadProgressContainer" class="upload-progress-container" style="display: none;">
                            <div class="upload-progress-bar">
                                <div class="upload-progress-fill" id="uploadProgressFill" style="width: 0%"></div>
                            </div>
                            <div class="upload-status">
                                <span id="uploadStatusText">Preparing upload...</span>
                                <span id="uploadPercentage">0%</span>
                            </div>
                        </div>
                    </div>
                    
                    <!-- Vector Store ID Section (shown by default) -->
                    <div id="vectorStoreIdSection" class="form-group">
                        <label for="ragStoreIdInput">Vector Store ID:</label>
                        <input type="text" id="ragStoreIdInput" class="modal-input" placeholder="Enter OpenAI Vector Store ID (max 100 chars)" maxlength="100">
                        <small class="help-text">Enter existing OpenAI Vector Store ID</small>
                    </div>
                </div>
                <div class="modal-footer">
                    <button id="ragModalSave" class="btn btn-primary">Save</button>
                    <button id="ragModalCancel" class="btn btn-secondary">Cancel</button>
                </div>
            </div>
        </div>

        <footer class="footer">
            <div class="footer-content">
                <p>SynapticFlow v1.0.0</p>
                <div class="footer-links">
                    <button id="testInjection" class="btn btn-small">Test Injection</button>
                    <button id="clearTranscript" class="btn btn-small">Clear Transcript</button>
                </div>
            </div>
        </footer>
    </div>

    <script src="renderer.js"></script>
</body>
</html> 